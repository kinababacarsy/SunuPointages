<div class="container">
  <div class="header">
    <a href="#">> Départements</a>
    <div class="search-bar">
      <input
        type="text"
        placeholder="Search"
        (input)="searchDepartements($event)"
      />
      <button>Filters</button>
      <button (click)="openCreateModal()">+ Créer un Département</button>
      <button
        *ngIf="selectedDepartements.length > 0"
        (click)="deleteSelectedDepartements()"
      >
        Supprimer
      </button>
    </div>
  </div>

  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th><input type="checkbox" (change)="toggleAllSelection()" /></th>
          <th>Départements</th>
          <th>Description <i class="fas fa-info-circle"></i></th>
          <th>Nombre d'employés</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let departement of paginatedDepartements">
          <td>
            <input
              type="checkbox"
              [(ngModel)]="departement.selected"
              (change)="toggleSelection(departement)"
            />
          </td>
          <td>{{ departement.nom_departement }}</td>
          <td>{{ departement.description }}</td>
          <td>{{ departement.nbre_employe }}</td>
          <td class="actions">
            <a (click)="viewDepartementDetails(departement.id)">Voir</a>
            <a (click)="openEditModal(departement)">Modifier</a>
            <a class="delete" (click)="openDeleteModal(departement)"
              >Supprimer</a
            >
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="pagination">
    <a class="nav-button" (click)="goToPage(currentPage - 1)">Précédent</a>
    <ul class="pages">
      <li *ngFor="let page of [].constructor(totalPages); let i = index">
        <a [class.active]="currentPage === i + 1" (click)="goToPage(i + 1)">{{
          i + 1
        }}</a>
      </li>
    </ul>
    <a class="nav-button" (click)="goToPage(currentPage + 1)">Suivant</a>
  </div>
</div>

<!-- Modal de création -->
<div class="modal-backdrop" *ngIf="showModal">
  <div class="modal">
    <header>
      <h2>Créer un Département</h2>
    </header>
    <form [formGroup]="departmentForm" (ngSubmit)="createDepartement($event)">
      <label for="department-name">Nom du Département</label>
      <input
        type="text"
        id="department-name"
        formControlName="nom_departement"
        placeholder="Entrez un nom"
      />
      <label for="description">Description</label>
      <textarea
        id="description"
        formControlName="description"
        placeholder="Entrez une description"
      ></textarea>
      <div class="buttons">
        <button type="button" (click)="closeModal()" class="cancel">
          ANNULER
        </button>
        <button type="submit" class="confirm">CONFIRMER</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal de modification -->
<div class="modal-backdrop" *ngIf="showEditModal">
  <div class="modal">
    <header>
      <h2>Modifier un Département</h2>
    </header>
    <form
      [formGroup]="editDepartmentForm"
      (ngSubmit)="updateDepartement($event)"
    >
      <label for="edit-department-name">Nom du Département</label>
      <input
        type="text"
        id="edit-department-name"
        formControlName="nom_departement"
        placeholder="Entrez un nom"
      />
      <label for="edit-description">Description</label>
      <textarea
        id="edit-description"
        formControlName="description"
        placeholder="Entrez une description"
      ></textarea>
      <div class="buttons">
        <button type="button" (click)="closeEditModal()" class="cancel">
          ANNULER
        </button>
        <button type="submit" class="confirm">CONFIRMER</button>
      </div>
    </form>
  </div>
</div>

<!-- Modal de confirmation de suppression -->
<div class="modal-backdrop" *ngIf="showDeleteModal">
  <div class="modal">
    <header>
      <h2>Confirmer la suppression</h2>
    </header>
    <div class="modal-body">
      <p>Êtes-vous sûr de vouloir supprimer ce département ?</p>
    </div>
    <div class="buttons">
      <button type="button" (click)="closeDeleteModal()" class="cancel">
        ANNULER
      </button>
      <button type="button" (click)="confirmDelete()" class="confirm">
        CONFIRMER
      </button>
    </div>
  </div>
</div>

<!-- Modal de confirmation de suppression multiple -->
<div class="modal-backdrop" *ngIf="showDeleteMultipleModal">
  <div class="modal">
    <header>
      <h2>Confirmer la suppression multiple</h2>
    </header>
    <div class="modal-body">
      <p>Êtes-vous sûr de vouloir supprimer les départements sélectionnés ?</p>
    </div>
    <div class="buttons">
      <button type="button" (click)="closeDeleteMultipleModal()" class="cancel">
        ANNULER
      </button>
      <button type="button" (click)="confirmDeleteMultiple()" class="confirm">
        CONFIRMER
      </button>
    </div>
  </div>
</div>
